#
# OPENSSL CSR REQUEST CONFIGURATION FILE
# ======================================
#
# QSEAL qualified client certificate request with PSD2 role: PSP_AS PSP_PI PSP_AI PSP_IC
# -------------------------------------------------------------------------
# See latest specification: ETSI TS 119 495 V1.2.1 (2018-11)
# https://www.etsi.org/deliver/etsi_ts/119400_119499/119495/01.02.01_60/ts_119495v010201p.pdf
#
oid_section             = new_oids
[ new_oids ]
organizationIdentifier  = "2.5.4.97"

[ req ]
default_bits            = 2048                                                      # RSA key size
encrypt_key             = yes                                                       # Protect private key: yes or no. yes recommended
default_md              = sha256                                                    # MD to use. sha256 recommended
utf8                    = yes                                                       # Input is UTF-8.
string_mask             = utf8only                                                  # Emit UTF-8 strings
prompt                  = no                                                        # Prompt for DN. yes or no.
distinguished_name      = client_dn                                                 # DN template. Mandatory to include organizationIdentifier
req_extensions          = client_reqext                                             # Desired extensions. Mandatory to include PSD2 QCStatements

[ client_dn ]
countryName             = "GB"                                                  # Country code - see doc above
organizationName        = "WSO2 (UK) LIMITED"                                                   # Organizational name

organizationIdentifier  = "PSDGB-OB-testTPP"                                                # Must be in format as shown above
commonName              = "TPP_0015800001HQQrZAAX"                                                    # Subject common name
emailAddress            = "testtpp@somemail.com"                                                 # Organisation email contact address

[ client_reqext ]
keyUsage                = critical,digitalSignature,nonRepudiation                  # Must be critical

subjectKeyIdentifier    = hash

# set the roles in config.properies file and qcStatement will generate
qcStatements            = DER:30818e3013060604008e4601063009060704008e4601060230770606040081982702306d304630440607040081982701010c065053505f41530607040081982701020c065053505f50490607040081982701030c065053505f41490607040081982701040c065053505f49430c1b46696e616e6369616c20436f6e6475637420417574686f726974790c0647422d464341